import{d as c,M as f,$ as _,ar as m,aT as T,r as b,U as $,L as V,Q as a,P as t,W as l,R as e,X as N,aM as O,aN as C,aG as R,aH as g,aI as h,aU as k,aV as v,aW as A,aX as E,J as q,T as z,O as D,aY as F,aZ as I,aq as p,a1 as B,a0 as S,S as j}from"./index-3ac8fdb4.js";import{u as H}from"./use-message-1695f3cf.js";import{N as K,a as J}from"./DrawerContent-00514f68.js";import{N as W}from"./headers-b417b264.js";import{N as U}from"./text-b2df8d05.js";import{N as M}from"./Flex-48f43524.js";const X={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},G=m("rect",{x:"48",y:"96",width:"416",height:"320",rx:"40",ry:"40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),L=m("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M112 160l144 112l144-112"},null,-1),Q=[G,L],Y=c({name:"MailOutline",render:function(i,d){return f(),_("svg",X,Q)}}),Z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ee=m("path",{d:"M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),se=m("path",{d:"M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),ae=[ee,se],re=c({name:"PersonOutline",render:function(i,d){return f(),_("svg",Z,ae)}}),{Axios:pe,AxiosError:te,CanceledError:ce,isCancel:fe,CancelToken:me,VERSION:Pe,all:ge,Cancel:he,isAxiosError:ke,spread:ve,toFormData:Ne,AxiosHeaders:_e,HttpStatusCode:xe,formToJSON:ye,getAdapter:be,mergeConfig:Ce}=T,oe=c({__name:"UpdateProfileBtnComponent",setup(P){const i=b(null),d=H(),o=b({data:{changePassword:{currentPassword:"",newPassword:"",reenteredNewPassword:""}},status:{drawer:!1},disabled:{updatePasswordBtn:!0}}),x={currentPassword:[{required:!0,message:"Password is required"}],newPassword:[{required:!0,message:"新密碼是必填的",trigger:["input","blur"]}],reenteredNewPassword:[{required:!0,message:"確認新密碼是必填的",trigger:["input","blur"]},{message:"新密碼與確認新密碼不一致!",trigger:["input","blur"],validator:()=>o.value.data.changePassword.newPassword===o.value.data.changePassword.reenteredNewPassword}]},{mutate:u,isPending:w}=$({mutationFn:async()=>await A.updatePassword.api({oldPassword:o.value.data.changePassword.currentPassword,newPassword:o.value.data.changePassword.newPassword}),onSuccess:async r=>{var s,n,y;if(r.msg==="Sucess! Password Updated"){d.success("更新密碼成功");return}r instanceof te&&(((s=r.response)==null?void 0:s.status)===400||((n=r.response)==null?void 0:n.status)===403||((y=r.response)==null?void 0:y.status)===401)&&d.error("更新密碼失敗")}});return V(o.value.data.changePassword,()=>{const{data:r}=o.value,s=!!(r.changePassword.currentPassword&&r.changePassword.newPassword&&r.changePassword.reenteredNewPassword&&r.changePassword.reenteredNewPassword===r.changePassword.newPassword);o.value.disabled.updatePasswordBtn=!s}),(r,s)=>(f(),_("div",null,[a(e(N),{type:"primary",strong:"",block:"",onClick:s[0]||(s[0]=n=>e(o).status.drawer=!0)},{default:t(()=>s[9]||(s[9]=[l(" 編輯個人資料 ")])),_:1}),a(e(J),{show:e(o).status.drawer,"onUpdate:show":s[8]||(s[8]=n=>e(o).status.drawer=n),width:502,height:500,placement:"bottom"},{default:t(()=>[a(e(K),{title:"Stoner"},{default:t(()=>[a(e(O),{type:"segment",animated:""},{default:t(()=>[a(e(C),{name:"profile",tab:"更改個人資料"},{default:t(()=>s[10]||(s[10]=[l(" 開發中... ")])),_:1}),a(e(C),{name:"password",tab:"更改密碼"},{default:t(()=>[a(e(R),{ref_key:"formRef",ref:i,model:e(o).data.changePassword,rules:x},{default:t(()=>[a(e(g),{path:"currentPassword",label:"現在密碼"},{default:t(()=>[a(e(h),{value:e(o).data.changePassword.currentPassword,"onUpdate:value":s[1]||(s[1]=n=>e(o).data.changePassword.currentPassword=n),type:"password","show-password-on":"click",onKeydown:s[2]||(s[2]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),a(e(g),{path:"newPassword",label:"新密碼"},{default:t(()=>[a(e(h),{value:e(o).data.changePassword.newPassword,"onUpdate:value":s[3]||(s[3]=n=>e(o).data.changePassword.newPassword=n),type:"password","show-password-on":"click",onKeydown:s[4]||(s[4]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),a(e(g),{path:"reenteredNewPassword",label:"確認新密碼"},{default:t(()=>[a(e(h),{value:e(o).data.changePassword.reenteredNewPassword,"onUpdate:value":s[5]||(s[5]=n=>e(o).data.changePassword.reenteredNewPassword=n),type:"password","show-password-on":"click",onKeydown:s[6]||(s[6]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),a(e(N),{round:"",type:"primary",disabled:e(o).disabled.updatePasswordBtn,loading:e(w),onClick:s[7]||(s[7]=n=>e(u)())},{default:t(()=>s[11]||(s[11]=[l(" 更新密碼 ")])),_:1},8,["disabled","loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])]))}}),Be=c({__name:"index",setup(P){const i=E(),{getUser:d}=q(i),o=z();return(x,u)=>(f(),D(e(B),{vertical:"",justify:"space-between"},{default:t(()=>{var w;return[a(e(F),{title:"個人資料"},I({"header-extra":t(()=>{var r;return[l(p((r=e(d))!=null&&r.emailVerified?"已驗證":"未驗證"),1)]}),default:t(()=>[a(e(W),null,{default:t(()=>{var r;return[l(p((r=e(d))==null?void 0:r.name),1)]}),_:1}),a(e(B),null,{default:t(()=>[a(e(M),{align:"center"},{default:t(()=>[a(e(S),{size:"16"},{default:t(()=>[a(e(Y))]),_:1}),a(e(U),null,{default:t(()=>{var r;return[l(p((r=e(d))==null?void 0:r.email),1)]}),_:1})]),_:1}),a(e(M),{align:"center"},{default:t(()=>[a(e(S),{size:""},{default:t(()=>[a(e(re))]),_:1}),a(e(U),null,{default:t(()=>{var r;return[l(p((r=e(d))==null?void 0:r.role),1)]}),_:1})]),_:1})]),_:1})]),_:2},[(w=e(d))!=null&&w.emailVerified?void 0:{name:"action",fn:t(()=>[a(e(N),{type:"primary",strong:"",secondary:"",block:"",size:"small",onClick:u[0]||(u[0]=r=>e(o).push(e(j).profileEmailVerify))},{default:t(()=>u[1]||(u[1]=[l(" 前往驗證 ")])),_:1})]),key:"0"}]),1024),a(oe)]}),_:1}))}});export{Be as default};
