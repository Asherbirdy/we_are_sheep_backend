var ct=(a,t,s)=>{if(!t.has(a))throw TypeError("Cannot "+s)};var e=(a,t,s)=>(ct(a,t,"read from private field"),s?s.call(a):t.get(a)),c=(a,t,s)=>{if(t.has(a))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(a):t.set(a,s)},d=(a,t,s,i)=>(ct(a,t,"write to private field"),i?i.call(a,s):t.set(a,s),s);var p=(a,t,s)=>(ct(a,t,"access private method"),s);import{an as Wt,ao as _t,ap as k,aq as ft,ar as nt,as as Ht,at as It,au as xt,av as Kt,aw as Gt,ax as Jt,ay as Tt,az as Yt,aA as Zt,e as Xt,aB as qt,aC as te,L as at,aD as Qt,aE as ee,aF as Et,aG as se,d as jt,M as ot,T as zt,am as lt,aH as it,r as ae,R as u,O as Ft,P as w,Q as y,aI as ie,aJ as Lt,W as Ut,U as re,aK as ne,Z as j,ak as dt,Y as oe,al as Dt,h as Nt}from"./index-29d4e570.js";import{N as Mt,a as rt}from"./DataTable-d54a5779.js";import{N as le}from"./Flex-35a60f47.js";import"./Dropdown-d2db4a3b.js";import"./index-d65ec873.js";var R,n,K,g,E,z,x,O,G,$,V,F,L,T,W,U,H,J,pt,Y,mt,Z,bt,X,gt,q,vt,tt,yt,et,Rt,ht,$t,Bt,he=(Bt=class extends Wt{constructor(t,s){super();c(this,U);c(this,J);c(this,Y);c(this,Z);c(this,X);c(this,q);c(this,tt);c(this,et);c(this,ht);c(this,R,void 0);c(this,n,void 0);c(this,K,void 0);c(this,g,void 0);c(this,E,void 0);c(this,z,void 0);c(this,x,void 0);c(this,O,void 0);c(this,G,void 0);c(this,$,void 0);c(this,V,void 0);c(this,F,void 0);c(this,L,void 0);c(this,T,void 0);c(this,W,new Set);this.options=s,d(this,R,t),d(this,O,null),d(this,x,_t()),this.options.experimental_prefetchInRender||e(this,x).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(e(this,n).addObserver(this),Pt(e(this,n),this.options)?p(this,U,H).call(this):this.updateResult(),p(this,X,gt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return wt(e(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return wt(e(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,p(this,q,vt).call(this),p(this,tt,yt).call(this),e(this,n).removeObserver(this)}setOptions(t,s){const i=this.options,h=e(this,n);if(this.options=e(this,R).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof k(this.options.enabled,e(this,n))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");p(this,et,Rt).call(this),e(this,n).setOptions(this.options),i._defaulted&&!ft(this.options,i)&&e(this,R).getQueryCache().notify({type:"observerOptionsUpdated",query:e(this,n),observer:this});const r=this.hasListeners();r&&At(e(this,n),h,this.options,i)&&p(this,U,H).call(this),this.updateResult(s),r&&(e(this,n)!==h||k(this.options.enabled,e(this,n))!==k(i.enabled,e(this,n))||nt(this.options.staleTime,e(this,n))!==nt(i.staleTime,e(this,n)))&&p(this,J,pt).call(this);const o=p(this,Y,mt).call(this);r&&(e(this,n)!==h||k(this.options.enabled,e(this,n))!==k(i.enabled,e(this,n))||o!==e(this,T))&&p(this,Z,bt).call(this,o)}getOptimisticResult(t){const s=e(this,R).getQueryCache().build(e(this,R),t),i=this.createResult(s,t);return ce(this,i)&&(d(this,g,i),d(this,z,this.options),d(this,E,e(this,n).state)),i}getCurrentResult(){return e(this,g)}trackResult(t,s){const i={};return Object.keys(t).forEach(h=>{Object.defineProperty(i,h,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(h),s==null||s(h),t[h])})}),i}trackProp(t){e(this,W).add(t)}getCurrentQuery(){return e(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=e(this,R).defaultQueryOptions(t),i=e(this,R).getQueryCache().build(e(this,R),s);return i.fetch().then(()=>this.createResult(i,s))}fetch(t){return p(this,U,H).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),e(this,g)))}createResult(t,s){var kt;const i=e(this,n),h=this.options,r=e(this,g),o=e(this,E),v=e(this,z),D=t!==i?t.state:e(this,K),{state:I}=t;let f={...I},Q=!1,l;if(s._optimisticResults){const b=this.hasListeners(),A=!b&&Pt(t,s),B=b&&At(t,i,s,h);(A||B)&&(f={...f,...Jt(I.data,t.options)}),s._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:_,errorUpdatedAt:N,status:S}=f;if(s.select&&f.data!==void 0)if(r&&f.data===(o==null?void 0:o.data)&&s.select===e(this,G))l=e(this,$);else try{d(this,G,s.select),l=s.select(f.data),l=Tt(r==null?void 0:r.data,l,s),d(this,$,l),d(this,O,null)}catch(b){d(this,O,b)}else l=f.data;if(s.placeholderData!==void 0&&l===void 0&&S==="pending"){let b;if(r!=null&&r.isPlaceholderData&&s.placeholderData===(v==null?void 0:v.placeholderData))b=r.data;else if(b=typeof s.placeholderData=="function"?s.placeholderData((kt=e(this,V))==null?void 0:kt.state.data,e(this,V)):s.placeholderData,s.select&&b!==void 0)try{b=s.select(b),d(this,O,null)}catch(A){d(this,O,A)}b!==void 0&&(S="success",l=Tt(r==null?void 0:r.data,b,s),Q=!0)}e(this,O)&&(_=e(this,O),l=e(this,$),N=Date.now(),S="error");const M=f.fetchStatus==="fetching",P=S==="pending",ut=S==="error",Ct=P&&M,Ot=l!==void 0,C={status:S,fetchStatus:f.fetchStatus,isPending:P,isSuccess:S==="success",isError:ut,isInitialLoading:Ct,isLoading:Ct,data:l,dataUpdatedAt:f.dataUpdatedAt,error:_,errorUpdatedAt:N,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>D.dataUpdateCount||f.errorUpdateCount>D.errorUpdateCount,isFetching:M,isRefetching:M&&!P,isLoadingError:ut&&!Ot,isPaused:f.fetchStatus==="paused",isPlaceholderData:Q,isRefetchError:ut&&Ot,isStale:St(t,s),refetch:this.refetch,promise:e(this,x)};if(this.options.experimental_prefetchInRender){const b=st=>{C.status==="error"?st.reject(C.error):C.data!==void 0&&st.resolve(C.data)},A=()=>{const st=d(this,x,C.promise=_t());b(st)},B=e(this,x);switch(B.status){case"pending":t.queryHash===i.queryHash&&b(B);break;case"fulfilled":(C.status==="error"||C.data!==B.value)&&A();break;case"rejected":(C.status!=="error"||C.error!==B.reason)&&A();break}}return C}updateResult(t){const s=e(this,g),i=this.createResult(e(this,n),this.options);if(d(this,E,e(this,n).state),d(this,z,this.options),e(this,E).data!==void 0&&d(this,V,e(this,n)),ft(i,s))return;d(this,g,i);const h={},r=()=>{if(!s)return!0;const{notifyOnChangeProps:o}=this.options,v=typeof o=="function"?o():o;if(v==="all"||!v&&!e(this,W).size)return!0;const m=new Set(v??e(this,W));return this.options.throwOnError&&m.add("error"),Object.keys(e(this,g)).some(D=>{const I=D;return e(this,g)[I]!==s[I]&&m.has(I)})};(t==null?void 0:t.listeners)!==!1&&r()&&(h.listeners=!0),p(this,ht,$t).call(this,{...h,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&p(this,X,gt).call(this)}},R=new WeakMap,n=new WeakMap,K=new WeakMap,g=new WeakMap,E=new WeakMap,z=new WeakMap,x=new WeakMap,O=new WeakMap,G=new WeakMap,$=new WeakMap,V=new WeakMap,F=new WeakMap,L=new WeakMap,T=new WeakMap,W=new WeakMap,U=new WeakSet,H=function(t){p(this,et,Rt).call(this);let s=e(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Ht)),s},J=new WeakSet,pt=function(){p(this,q,vt).call(this);const t=nt(this.options.staleTime,e(this,n));if(It||e(this,g).isStale||!xt(t))return;const i=Kt(e(this,g).dataUpdatedAt,t)+1;d(this,F,setTimeout(()=>{e(this,g).isStale||this.updateResult()},i))},Y=new WeakSet,mt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(e(this,n)):this.options.refetchInterval)??!1},Z=new WeakSet,bt=function(t){p(this,tt,yt).call(this),d(this,T,t),!(It||k(this.options.enabled,e(this,n))===!1||!xt(e(this,T))||e(this,T)===0)&&d(this,L,setInterval(()=>{(this.options.refetchIntervalInBackground||Gt.isFocused())&&p(this,U,H).call(this)},e(this,T)))},X=new WeakSet,gt=function(){p(this,J,pt).call(this),p(this,Z,bt).call(this,p(this,Y,mt).call(this))},q=new WeakSet,vt=function(){e(this,F)&&(clearTimeout(e(this,F)),d(this,F,void 0))},tt=new WeakSet,yt=function(){e(this,L)&&(clearInterval(e(this,L)),d(this,L,void 0))},et=new WeakSet,Rt=function(){const t=e(this,R).getQueryCache().build(e(this,R),this.options);if(t===e(this,n))return;const s=e(this,n);d(this,n,t),d(this,K,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},ht=new WeakSet,$t=function(t){Yt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(e(this,g))}),e(this,R).getQueryCache().notify({query:e(this,n),type:"observerResultsUpdated"})})},Bt);function ue(a,t){return k(t.enabled,a)!==!1&&a.state.data===void 0&&!(a.state.status==="error"&&t.retryOnMount===!1)}function Pt(a,t){return ue(a,t)||a.state.data!==void 0&&wt(a,t,t.refetchOnMount)}function wt(a,t,s){if(k(t.enabled,a)!==!1){const i=typeof s=="function"?s(a):s;return i==="always"||i!==!1&&St(a,t)}return!1}function At(a,t,s,i){return(a!==t||k(i.enabled,a)===!1)&&(!s.suspense||a.state.status!=="error")&&St(a,s)}function St(a,t){return k(t.enabled,a)!==!1&&a.isStaleByTime(nt(t.staleTime,a))}function ce(a,t){return!ft(a.getCurrentResult(),t)}function de(a,t,s){const i=s||Zt(),h=Xt(()=>{const l=qt(t);typeof l.enabled=="function"&&(l.enabled=l.enabled());const _=i.defaultQueryOptions(l);return _._optimisticResults=i.isRestoring.value?"isRestoring":"optimistic",_}),r=new a(i,h.value),o=te(r.getCurrentResult());let v=()=>{};at(i.isRestoring,l=>{l||(v(),v=r.subscribe(_=>{Qt(o,_)}))},{immediate:!0});const m=()=>{r.setOptions(h.value),Qt(o,r.getCurrentResult())};at(h,m),ee(()=>{v()});const D=(...l)=>(m(),o.refetch(...l)),I=()=>new Promise((l,_)=>{let N=()=>{};const S=()=>{if(h.value.enabled!==!1){r.setOptions(h.value);const M=r.getOptimisticResult(h.value);M.isStale?(N(),r.fetchOptimistic(h.value).then(l,P=>{Et(h.value.throwOnError,[P,r.getCurrentQuery()])?_(P):l(r.getCurrentResult())})):(N(),l(M))}};S(),N=at(h,S)});at(()=>o.error,l=>{if(o.isError&&!o.isFetching&&Et(h.value.throwOnError,[l,r.getCurrentQuery()]))throw l});const Q=se(o);for(const l in o)typeof o[l]=="function"&&(Q[l]=o[l]);return Q.suspense=I,Q.refetch=D,Q}function fe(a,t){return de(he,a,t)}const pe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},me=lt("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M244 400L100 256l144-144"},null,-1),be=lt("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M120 256h292"},null,-1),ge=[me,be],ve=jt({name:"ArrowBack",render:function(t,s){return ot(),zt("svg",pe,ge)}});var Vt=(a=>(a.userShowMe="useUserApi_showMe",a.sheepList="useSheepApi_getSheepList",a))(Vt||{});const ye=a=>{switch(a){case"teenager":return"(青少年)";case"college":return"(大專)";case"youth":return"(青職)";case"middleAge":return"(壯年)";case"elder":return"(年長)";default:return""}},Re={createSheep:async a=>await it.post({url:"/sheep/create",data:a}),getSheepList:async()=>await it.get({url:"/sheep/list"}),editSheep:async a=>await it.post({url:`/sheep/edit?sheepId=${a}`,data:{name:"test"}}),deleteSheep:async a=>await it.post({url:`/sheep/delete?sheepId=${a}`})},xe=jt({__name:"index",setup(a){const t=ae({data:{details:null},page:{current:"home"}}),{data:s}=fe({queryKey:[Vt.sheepList],queryFn:()=>Re.getSheepList()}),i=()=>[{title:"姓名",key:"name",width:"20%"},{title:"標籤",key:"tags",render(h){return h.tags.map(o=>Nt(rt,{style:{marginRight:"6px"},type:"info",bordered:!1,size:"small"},{default:()=>o}))}},{title:"",key:"actions",width:"30%",render(h){return Nt(Dt,{size:"small",onClick:()=>{t.value.page.current="details",t.value.data.details=h,console.log(t.value.data.details)}},{default:()=>"詳細形況"})}}];return(h,r)=>(ot(),zt("div",null,[u(t).page.current==="home"?(ot(),Ft(u(Ut),{key:0,vertical:""},{default:w(()=>[y(u(ie),{type:"segment",animated:""},{default:w(()=>[y(u(Lt),{name:"focus",tab:"重點牧養"},{default:w(()=>{var o;return[y(u(Mt),{bordered:!1,"single-line":!1,columns:i(),data:(o=u(s))==null?void 0:o.list.focusPersonList},null,8,["columns","data"])]}),_:1}),y(u(Lt),{name:"non-focus",tab:"其他名單"},{default:w(()=>{var o;return[y(u(Mt),{bordered:!1,"single-line":!1,columns:i(),data:(o=u(s))==null?void 0:o.list.nonFocusPersonList},null,8,["columns","data"])]}),_:1})]),_:1})]),_:1})):(ot(),Ft(u(Ut),{key:1,vertical:"",justify:"space-between",class:"h-[calc(100vh-100px)]"},{default:w(()=>[y(u(le),{vertical:""},{default:w(()=>{var o,v;return[y(u(re),{size:"26",onClick:r[0]||(r[0]=m=>u(t).page.current="home")},{default:w(()=>[y(u(ve))]),_:1}),y(u(ne),{title:`${(o=u(t).data.details)==null?void 0:o.name}${u(ye)((v=u(t).data.details)==null?void 0:v.ageRange)}`},{default:w(()=>[lt("div",null,[r[2]||(r[2]=j(" 狀態:")),y(u(rt),null,{default:w(()=>{var m;return[j(dt((m=u(t).data.details)==null?void 0:m.personStatus),1)]}),_:1})]),lt("div",null,[y(u(rt),null,{default:w(()=>r[3]||(r[3]=[j("標籤")])),_:1}),y(u(rt),null,{default:w(()=>{var m;return[j(dt((m=u(t).data.details)==null?void 0:m.tags),1)]}),_:1})])]),_:1},8,["title"]),y(u(oe),null,{default:w(()=>{var m;return[j(" 備註: "+dt(((m=u(t).data.details)==null?void 0:m.note)||"無備註"),1)]}),_:1})]}),_:1}),y(u(Dt),{block:"",type:"primary",onClick:r[1]||(r[1]=o=>u(t).page.current="home")},{default:w(()=>r[4]||(r[4]=[j(" 編輯 ")])),_:1})]),_:1}))]))}});export{xe as default};
