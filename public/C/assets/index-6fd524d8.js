import{d as c,M as f,$ as b,ar as m,bb as M,r as y,U as T,L as O,Q as r,P as t,W as l,R as e,X as _,b4 as R,b5 as C,a_ as V,a$ as g,b0 as h,bc as k,bd as v,be as A,bf as E,J as q,T as z,O as D,bg as F,bh as j,aq as p,a1 as B,a0 as S,S as I}from"./index-072a50e2.js";import{u as K}from"./use-message-9d34476e.js";import{N as H,a as J}from"./DrawerContent-c6df5a0f.js";import{N as L}from"./headers-55a4c4c5.js";import{N as U}from"./text-35c4b424.js";import{N as $}from"./Flex-844b49f4.js";const Q={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},W=m("rect",{x:"48",y:"96",width:"416",height:"320",rx:"40",ry:"40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),X=m("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M112 160l144 112l144-112"},null,-1),G=[W,X],Y=c({name:"MailOutline",render:function(i,d){return f(),b("svg",Q,G)}}),Z={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ee=m("path",{d:"M344 144c-3.92 52.87-44 96-88 96s-84.15-43.12-88-96c-4-55 35-96 88-96s92 42 88 96z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),se=m("path",{d:"M256 304c-87 0-175.3 48-191.64 138.6C62.39 453.52 68.57 464 80 464h352c11.44 0 17.62-10.48 15.65-21.4C431.3 352 343 304 256 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),re=[ee,se],ae=c({name:"PersonOutline",render:function(i,d){return f(),b("svg",Z,re)}}),{Axios:pe,AxiosError:te,CanceledError:ce,isCancel:fe,CancelToken:me,VERSION:Pe,all:ge,Cancel:he,isAxiosError:ke,spread:ve,toFormData:_e,AxiosHeaders:be,HttpStatusCode:Ne,formToJSON:xe,getAdapter:ye,mergeConfig:Ce}=M,oe=c({__name:"UpdateProfileBtnComponent",setup(P){const i=y(null),d=K(),o=y({data:{changePassword:{currentPassword:"",newPassword:"",reenteredNewPassword:""}},status:{drawer:!1},disabled:{updatePasswordBtn:!0}}),N={currentPassword:[{required:!0,message:"Password is required"}],newPassword:[{required:!0,message:"新密碼是必填的",trigger:["input","blur"]}],reenteredNewPassword:[{required:!0,message:"確認新密碼是必填的",trigger:["input","blur"]},{message:"新密碼與確認新密碼不一致!",trigger:["input","blur"],validator:()=>o.value.data.changePassword.newPassword===o.value.data.changePassword.reenteredNewPassword}]},{mutate:u,isPending:w}=T({mutationFn:async()=>await A.updatePassword.api({oldPassword:o.value.data.changePassword.currentPassword,newPassword:o.value.data.changePassword.newPassword}),onSuccess:async a=>{var s,n,x;if(a.msg==="Sucess! Password Updated"){d.success("更新密碼成功");return}a instanceof te&&(((s=a.response)==null?void 0:s.status)===400||((n=a.response)==null?void 0:n.status)===403||((x=a.response)==null?void 0:x.status)===401)&&d.error("更新密碼失敗")}});return O(o.value.data.changePassword,()=>{const{data:a}=o.value,s=!!(a.changePassword.currentPassword&&a.changePassword.newPassword&&a.changePassword.reenteredNewPassword&&a.changePassword.reenteredNewPassword===a.changePassword.newPassword);o.value.disabled.updatePasswordBtn=!s}),(a,s)=>(f(),b("div",null,[r(e(_),{type:"primary",strong:"",block:"",onClick:s[0]||(s[0]=n=>e(o).status.drawer=!0)},{default:t(()=>s[9]||(s[9]=[l(" 編輯個人資料 ")])),_:1}),r(e(J),{show:e(o).status.drawer,"onUpdate:show":s[8]||(s[8]=n=>e(o).status.drawer=n),width:502,height:500,placement:"bottom"},{default:t(()=>[r(e(H),{title:"Stoner"},{default:t(()=>[r(e(R),{type:"segment",animated:""},{default:t(()=>[r(e(C),{name:"profile",tab:"更改個人資料"},{default:t(()=>s[10]||(s[10]=[l(" 開發中... ")])),_:1}),r(e(C),{name:"password",tab:"更改密碼"},{default:t(()=>[r(e(V),{ref_key:"formRef",ref:i,model:e(o).data.changePassword,rules:N},{default:t(()=>[r(e(g),{path:"currentPassword",label:"現在密碼"},{default:t(()=>[r(e(h),{value:e(o).data.changePassword.currentPassword,"onUpdate:value":s[1]||(s[1]=n=>e(o).data.changePassword.currentPassword=n),type:"password","show-password-on":"click",onKeydown:s[2]||(s[2]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),r(e(g),{path:"newPassword",label:"新密碼"},{default:t(()=>[r(e(h),{value:e(o).data.changePassword.newPassword,"onUpdate:value":s[3]||(s[3]=n=>e(o).data.changePassword.newPassword=n),type:"password","show-password-on":"click",onKeydown:s[4]||(s[4]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),r(e(g),{path:"reenteredNewPassword",label:"確認新密碼"},{default:t(()=>[r(e(h),{value:e(o).data.changePassword.reenteredNewPassword,"onUpdate:value":s[5]||(s[5]=n=>e(o).data.changePassword.reenteredNewPassword=n),type:"password","show-password-on":"click",onKeydown:s[6]||(s[6]=k(v(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["path"]),r(e(_),{round:"",type:"primary",disabled:e(o).disabled.updatePasswordBtn,loading:e(w),onClick:s[7]||(s[7]=n=>e(u)())},{default:t(()=>s[11]||(s[11]=[l(" 更新密碼 ")])),_:1},8,["disabled","loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])]))}}),Be=c({__name:"index",setup(P){const i=E(),{getUser:d}=q(i),o=z();return(N,u)=>(f(),D(e(B),{vertical:"",justify:"space-between"},{default:t(()=>{var w;return[r(e(F),{title:"個人資料"},j({"header-extra":t(()=>{var a;return[l(p((a=e(d))!=null&&a.emailVerified?"已驗證":"未驗證"),1)]}),default:t(()=>[r(e(L),null,{default:t(()=>{var a;return[l(p((a=e(d))==null?void 0:a.name),1)]}),_:1}),r(e(B),null,{default:t(()=>[r(e($),{align:"center"},{default:t(()=>[r(e(S),{size:"16"},{default:t(()=>[r(e(Y))]),_:1}),r(e(U),null,{default:t(()=>{var a;return[l(p((a=e(d))==null?void 0:a.email),1)]}),_:1})]),_:1}),r(e($),{align:"center"},{default:t(()=>[r(e(S),{size:""},{default:t(()=>[r(e(ae))]),_:1}),r(e(U),null,{default:t(()=>{var a;return[l(p((a=e(d))==null?void 0:a.role),1)]}),_:1})]),_:1})]),_:1})]),_:2},[(w=e(d))!=null&&w.emailVerified?void 0:{name:"action",fn:t(()=>[r(e(_),{type:"primary",strong:"",secondary:"",block:"",size:"small",onClick:u[0]||(u[0]=a=>e(o).push(e(I).profileEmailVerify))},{default:t(()=>u[1]||(u[1]=[l(" 前往驗證 ")])),_:1})]),key:"0"}]),1024),r(oe)]}),_:1}))}});export{Be as default};
