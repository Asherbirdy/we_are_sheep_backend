import{f as ae,H as p,I as j,o as u,c as _,a as t,F as E,x as L,z as te,b as a,w as l,d as k,t as A,y as O,A as z,h as V,C as le,aj as S,ak as U,e as oe,J as ne,j as re,_ as ue}from"./C5-ExHym.js";import{c as B,a as v,_ as ie,b as de,d as me}from"./RgFb_OdD.js";import{_ as ce}from"./CqZtryJP.js";import{u as F}from"./B9WqHi4_.js";import{P as R}from"./xm1msvh1.js";const I={login:async g=>await F("/auth/login",{method:"POST",body:g,server:!1,lazy:!0,immediate:!1,watch:!1}),register:async g=>await F("/auth/userRegister",{method:"POST",body:g,server:!1,lazy:!0,immediate:!1,watch:!1})},fe={class:"flex flex-col min-h-screen"},pe={class:"bg-gray-100 p-4 flex justify-between"},_e={class:"hidden md:block"},ve={class:"flex space-x-4"},ge={class:"flex-grow mx-2"},be={class:"fixed bottom-0 left-0 right-0 bg-gray-100 shadow-lg none md:hidden"},xe={class:"grid grid-cols-3 h-16"},we={class:"relative z-10"},ye={class:"flex"},ke={class:"form-box p-4"},Ve={class:"flex justify-center"},he={class:"flex justify-center"},Ce={key:0,class:"result-status p-4"},Se={key:0,class:"flex flex-col items-center justify-center"},Ue={key:1,class:"flex flex-col items-center justify-center"},Re=ae({__name:"default",async setup(g){let n,b;const q=[{label:"生命讀經",to:R.Home},{label:"近期活動",to:R.News},{label:"會員中心",to:R.Login}],x=p(!1),c=p(!1);p(!0);const w=p(null),J=B({email:v().email("Invalid email").required("Required"),password:v().min(8,"Must be at least 8 characters").required("Required")}),M=B({email:v().email("無效emai").required("Required"),password:v().min(8,"Must be at least 8 characters").required("Required"),confirmPassword:v().required("Required"),serialNumber:v().required("Required")}),r=p({email:"asherbirder@gmail.com",password:"password"}),o=p({name:"",email:"@gmail.com",password:"password",confirmPassword:"password",serialNumber:""}),{data:h,execute:$,error:G,status:H}=([n,b]=j(()=>I.login(r.value)),n=await n,b(),n),{data:C,execute:W,error:D,status:K}=([n,b]=j(()=>I.register(o.value)),n=await n,b(),n),Q=()=>{c.value=!0},X=()=>{c.value=!1},y=f=>{w.value=f,setTimeout(()=>{w.value=null},2e3)},Y=async f=>{await $(),console.log(r.value.email),console.log(r.value.password),console.log("LoginState",f.data),G.value&&y(!1);const e=S(U.AccessToken),i=S(U.RefreshToken);h.value&&(e.value=h.value.token.accessTokenJWT,i.value=h.value.token.refreshTokenJWT,y(!0))},Z=async f=>{var i;await W(),D.value&&(alert("註冊錯誤"),y(!1));const e=S(U.TokenUser);C.value&&(console.log(C.value),e.value=JSON.stringify((i=C.value)==null?void 0:i.tokenUser),y(!0),c.value=!0)},ee=()=>{x.value=!x.value,console.log("彈窗被打開")};return(f,e)=>{const i=oe,d=ie,m=de,T=ne,N=me,P=re,se=ce;return u(),_("div",fe,[t("header",pe,[e[8]||(e[8]=t("div",null,"LOGO",-1)),t("div",_e,[t("nav",ve,[(u(),_(E,null,L(q,s=>a(i,{key:s.to,to:s.to,class:"text-gray-600"},{default:l(()=>[k(A(s.label),1)]),_:2},1032,["to"])),64))])])]),t("main",ge,[te(f.$slots,"default",{},void 0,!0)]),t("nav",be,[t("div",xe,[(u(),_(E,null,L(q,s=>t("div",{key:s.to,class:"flex items-center justify-center border-r border-gray-200 last:border-r-0"},[a(i,{to:s.to,class:"text-gray-600",onClick:ee},{default:l(()=>[k(A(s.label),1)]),_:2},1032,["to"])])),64))])]),t("div",we,[a(se,{modelValue:x.value,"onUpdate:modelValue":e[7]||(e[7]=s=>x.value=s)},{default:l(()=>[t("div",ye,[t("button",{class:O(["base font rounded block flex-1 relative group",[{active:c.value}]]),onClick:Q}," 登入 ",2),t("button",{class:O(["base font rounded block flex-1 relative group",[{active:!c.value}]]),onClick:X}," 註冊 ",2)]),t("div",ke,[c.value?(u(),z(N,{key:0,schema:V(J),state:r.value,class:"space-y-4"},{default:l(()=>[a(m,{label:"Email",name:"email"},{default:l(()=>[a(d,{modelValue:r.value.email,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value.email=s)},null,8,["modelValue"])]),_:1}),a(m,{label:"Password",name:"password"},{default:l(()=>[a(d,{modelValue:r.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>r.value.password=s),type:"password"},null,8,["modelValue"])]),_:1}),t("div",Ve,[a(T,{loading:V(H)==="pending",type:"submit",onClick:Y},{default:l(()=>e[9]||(e[9]=[k(" 登入 ")])),_:1},8,["loading"])])]),_:1},8,["schema","state"])):(u(),z(N,{key:1,schema:V(M),state:o.value,class:"space-y-4",onSubmit:Z},{default:l(()=>[a(m,{label:"Name",name:"name"},{default:l(()=>[a(d,{modelValue:o.value.name,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.name=s)},null,8,["modelValue"])]),_:1}),a(m,{label:"Email",name:"email"},{default:l(()=>[a(d,{modelValue:o.value.email,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.email=s)},null,8,["modelValue"])]),_:1}),a(m,{label:"Password",name:"password"},{default:l(()=>[a(d,{modelValue:o.value.password,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.password=s),type:"password"},null,8,["modelValue"])]),_:1}),a(m,{label:"Confirm Password",name:"confirmPassword"},{default:l(()=>[a(d,{modelValue:o.value.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.confirmPassword=s),type:"password"},null,8,["modelValue"])]),_:1}),a(m,{label:"序號",name:"serialnumber"},{default:l(()=>[a(d,{modelValue:o.value.serialNumber,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.serialNumber=s),type:"text"},null,8,["modelValue"])]),_:1}),t("div",he,[a(T,{class:"bg-blue-500 text-white p-2 rounded-md",loading:V(K)==="pending",type:"submit"},{default:l(()=>e[10]||(e[10]=[k(" 註冊 ")])),_:1},8,["loading"])])]),_:1},8,["schema","state"]))]),w.value!==null?(u(),_("div",Ce,[w.value?(u(),_("div",Se,[a(P,{name:"material-symbols:check-circle",class:"text-green-500 text-7xl"}),e[11]||(e[11]=t("div",{class:"text-white"},"成功",-1))])):(u(),_("div",Ue,[a(P,{name:"material-symbols:cancel",class:"text-red-500 text-7xl"}),e[12]||(e[12]=t("div",{class:"text-white"},"失敗",-1))]))])):le("",!0)]),_:1},8,["modelValue"])]),e[13]||(e[13]=t("footer",{class:"bg-gray-100 p-4 mt-16"},[t("div",{class:"text-center"},"Footer")],-1))])}}}),Ee=ue(Re,[["__scopeId","data-v-e3be3b83"]]);export{Ee as default};
