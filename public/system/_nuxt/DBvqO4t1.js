import{f as h,ac as K,r as V,K as C,o as k,c as A,b as t,w as i,d as D,h as e,a as b,F as M,k as w,m as B,G as z}from"./B0J0WvHt.js";import{u as R,a as $,D as L,_ as O}from"./BKH7k154.js";import{_ as H}from"./BSdAw5oD.js";import{_ as F}from"./Dozi95TJ.js";import{r as J}from"./DDfxx48F.js";import{_ as I}from"./DXDzdJOA.js";import{a as N,_ as S}from"./xO2dniIr.js";import{c as E,a as T}from"./DS_ed5Xt.js";import{_ as P}from"./jZC4qxGa.js";import"./DYXc8vUg.js";import"./ToWMlutv.js";import"./CRmINWLG.js";const Q={class:"p-4"},W=h({__name:"CreateDistrictBtnComponent",emits:["refresh"],async setup(U,{emit:c}){let d,f;const l=c,m=R(),v=K(),o=V({data:{name:""},modal:!1}),{execute:y,error:a,status:n}=([d,f]=C(()=>$.create(o.value.data)),d=await d,f(),d),_=E({name:T().required("請輸入區的名稱")}),u=async()=>{var r;m.setName(o.value.data.name),await y(),((r=a==null?void 0:a.value)==null?void 0:r.data.error)==="CREATE_ERROR"&&(o.value.modal=!1,console.log(o.value),v.add({title:a.value.data.msg})),l("refresh"),o.value.modal=!1};return(r,s)=>{const p=w,g=I,q=N,G=S,j=F;return k(),A(M,null,[t(p,{onClick:s[0]||(s[0]=x=>e(o).modal=!0)},{default:i(()=>s[3]||(s[3]=[D(" 新增 ")])),_:1}),t(j,{modelValue:e(o).modal,"onUpdate:modelValue":s[2]||(s[2]=x=>e(o).modal=x)},{default:i(()=>[b("div",Q,[t(G,{schema:e(_),state:e(o).data,class:"space-y-4",onSubmit:u},{default:i(()=>[t(q,{label:"名稱",name:"name"},{default:i(()=>[t(g,{modelValue:e(o).data.name,"onUpdate:modelValue":s[1]||(s[1]=x=>e(o).data.name=x)},null,8,["modelValue"])]),_:1}),t(p,{type:"submit",loading:e(n)==="pending"},{default:i(()=>s[4]||(s[4]=[D(" Submit ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])])]),_:1},8,["modelValue"])],64)}}}),X={class:"flex items-center justify-between"},Y=h({__name:"EditDistrictFormComponent",props:{data:{}},emits:["refresh"],setup(U,{emit:c}){const d=U,f=c,l=V({button:{edit:{loading:!1}}}),m=B(()=>d.data?{...d.data}:{_id:"",name:"",active:!1}),v=E({name:T().required("請輸入區的名稱")}),o=async()=>{l.value.button.edit.loading=!0,await $.edit({newName:m.value.name,districtId:m.value._id}).execute(),l.value.button.edit.loading=!1,f("refresh")};return(y,a)=>{const n=w,_=I,u=N,r=S,s=P;return k(),z(s,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:i(()=>[b("div",X,[a[2]||(a[2]=b("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," 編輯區域 ",-1)),t(n,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:a[0]||(a[0]=p=>y.$emit("refresh"))})])]),default:i(()=>[t(r,{schema:e(v),state:e(m),class:"space-y-4",onSubmit:o},{default:i(()=>[t(u,{label:"名稱",name:"name"},{default:i(()=>[t(_,{modelValue:e(m).name,"onUpdate:modelValue":a[1]||(a[1]=p=>e(m).name=p)},null,8,["modelValue"])]),_:1}),t(n,{type:"submit",loading:e(l).button.edit.loading},{default:i(()=>a[3]||(a[3]=[D(" Submit ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),Z={class:"flex justify-end"},ue=h({__name:"district",async setup(U){let c,d;const f=R(),l=V({modal:{edit:!1,district:{_id:"",name:"",active:!1}}}),{data:m}=([c,d]=C(()=>$.getAll()),c=await c,d(),c),v=[{key:"_id",label:"ID"},{key:"name",label:"名稱"},{key:"active",label:"狀態"},{key:"actions"}],o=B(()=>{var u;const n=(u=m.value)==null?void 0:u.districts;return Array.isArray(n)?f.saveIDs(n):console.error("districts 是 undefined 或不是一個陣列"),(n==null?void 0:n.map(r=>({_id:r._id,name:r.name,active:r.active?"啟用":"停用"})))||[]}),y=n=>[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>{l.value.modal.edit=!0,l.value.modal.district=n}},{label:"Duplicate",icon:"i-heroicons-document-duplicate-20-solid"}]],a=()=>{J(L.getAll),l.value.modal.edit=!1};return(n,_)=>{const u=w,r=O,s=H,p=F;return k(),A("div",null,[b("div",Z,[t(W,{onRefresh:a})]),t(s,{rows:e(o),columns:v},{"actions-data":i(({row:g})=>[t(r,{items:y(g)},{default:i(()=>[t(u,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["rows"]),t(p,{modelValue:e(l).modal.edit,"onUpdate:modelValue":_[0]||(_[0]=g=>e(l).modal.edit=g),"prevent-close":""},{default:i(()=>[t(Y,{data:e(l).modal.district,onRefresh:a},null,8,["data"])]),_:1},8,["modelValue"])])}}});export{ue as default};
