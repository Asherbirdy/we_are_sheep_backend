import{f as h,G,H as V,I as C,o as k,c as $,b as t,w as s,d as U,h as e,a as y,F as j,J as w,q as B,A as M}from"./C5-ExHym.js";import{u as D,_ as z,a as H,D as J,b as K}from"./wJty8FPQ.js";import{_ as R}from"./CqZtryJP.js";import{r as L}from"./B9WqHi4_.js";import{c as A,a as F,_ as E,b as I,d as N}from"./RgFb_OdD.js";const O={class:"p-4"},P=h({__name:"CreateDistrictBtnComponent",emits:["refresh"],async setup(g,{emit:c}){let d,l;const _=c,m=G(),n=V({data:{name:""},modal:!1}),{execute:v,error:r,status:a}=([d,l]=C(()=>D.create(n.value.data)),d=await d,l(),d),i=A({name:F().required("請輸入區的名稱")}),b=async()=>{var p;await v(),((p=r==null?void 0:r.value)==null?void 0:p.data.error)==="CREATE_ERROR"&&(n.value.modal=!1,m.add({title:r.value.data.msg})),_("refresh"),n.value.modal=!1};return(p,o)=>{const f=w,u=E,S=I,q=N,T=R;return k(),$(j,null,[t(f,{onClick:o[0]||(o[0]=x=>e(n).modal=!0)},{default:s(()=>o[3]||(o[3]=[U(" 新增 ")])),_:1}),t(T,{modelValue:e(n).modal,"onUpdate:modelValue":o[2]||(o[2]=x=>e(n).modal=x)},{default:s(()=>[y("div",O,[t(q,{schema:e(i),state:e(n).data,class:"space-y-4",onSubmit:b},{default:s(()=>[t(S,{label:"名稱",name:"name"},{default:s(()=>[t(u,{modelValue:e(n).data.name,"onUpdate:modelValue":o[1]||(o[1]=x=>e(n).data.name=x)},null,8,["modelValue"])]),_:1}),t(f,{type:"submit",loading:e(a)==="pending"},{default:s(()=>o[4]||(o[4]=[U(" Submit ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])])]),_:1},8,["modelValue"])],64)}}}),Q={class:"flex items-center justify-between"},W=h({__name:"EditDistrictFormComponent",props:{data:{}},emits:["refresh"],setup(g,{emit:c}){const d=g,l=c,_=V({button:{edit:{loading:!1}}}),m=B(()=>d.data?{...d.data}:{_id:"",name:"",active:!1}),n=A({name:F().required("請輸入區的名稱")}),v=async()=>{_.value.button.edit.loading=!0,await D.edit({newName:m.value.name,districtId:m.value._id}).execute(),_.value.button.edit.loading=!1,l("refresh")};return(r,a)=>{const i=w,b=E,p=I,o=N,f=z;return k(),M(f,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:s(()=>[y("div",Q,[a[2]||(a[2]=y("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," 編輯區域 ",-1)),t(i,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:a[0]||(a[0]=u=>r.$emit("refresh"))})])]),default:s(()=>[t(o,{schema:e(n),state:e(m),class:"space-y-4",onSubmit:v},{default:s(()=>[t(p,{label:"名稱",name:"name"},{default:s(()=>[t(b,{modelValue:e(m).name,"onUpdate:modelValue":a[1]||(a[1]=u=>e(m).name=u)},null,8,["modelValue"])]),_:1}),t(i,{type:"submit",loading:e(_).button.edit.loading},{default:s(()=>a[3]||(a[3]=[U(" Submit ")])),_:1},8,["loading"])]),_:1},8,["schema","state"])]),_:1})}}}),X={class:"flex justify-end"},oe=h({__name:"district",async setup(g){let c,d;const l=V({modal:{edit:!1,district:{_id:"",name:"",active:!1}}}),{data:_}=([c,d]=C(()=>D.getAll()),c=await c,d(),c),m=[{key:"_id",label:"ID"},{key:"name",label:"名稱"},{key:"active",label:"狀態"},{key:"actions"}],n=B(()=>{var a;return((a=_.value)==null?void 0:a.districts.map(i=>({_id:i._id,name:i.name,active:i.active?"啟用":"停用"})))||[]}),v=a=>[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>{l.value.modal.edit=!0,l.value.modal.district=a}},{label:"Duplicate",icon:"i-heroicons-document-duplicate-20-solid"}]],r=()=>{L(J.getAll),l.value.modal.edit=!1};return(a,i)=>{const b=w,p=K,o=H,f=R;return k(),$("div",null,[y("div",X,[t(P,{onRefresh:r})]),t(o,{rows:e(n),columns:m},{"actions-data":s(({row:u})=>[t(p,{items:v(u)},{default:s(()=>[t(b,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["rows"]),t(f,{modelValue:e(l).modal.edit,"onUpdate:modelValue":i[0]||(i[0]=u=>e(l).modal.edit=u),"prevent-close":""},{default:s(()=>[t(W,{data:e(l).modal.district,onRefresh:r},null,8,["data"])]),_:1},8,["modelValue"])])}}});export{oe as default};
