import{s as se,a0 as re,x as N,_ as ue,f as T,y as Q,z as de,A as G,a3 as ce,m as c,B as me,C as z,o as g,c as f,a as h,F as O,O as L,t as j,J as ve,H as U,P as W,b as r,I as P,a6 as E,r as X,n as ge,K as Y,w as v,d as J,h as F,k as x,Z as fe}from"./B0J0WvHt.js";import{u as H,a as be,_ as pe}from"./BKH7k154.js";import{_ as ye}from"./BSdAw5oD.js";import{u as K}from"./DDfxx48F.js";import{u as _e}from"./CRmINWLG.js";import{a as Ie,_ as Ae}from"./xO2dniIr.js";import{_ as Ce}from"./jZC4qxGa.js";import{_ as he}from"./Dozi95TJ.js";import{c as we,a as Z}from"./DS_ed5Xt.js";import"./DYXc8vUg.js";import"./ToWMlutv.js";const ee={getAll:async(e={})=>await K("/userSerialNumber/getAll",{method:"GET",server:!1,lazy:!1,...e}),create:async e=>await K("/userSerialNumber/create",{method:"POST",body:e,watch:!1,immediate:!1})},y=se(N.ui.strategy,N.ui.select,re),Se=T({components:{UIcon:Q},inheritAttrs:!1,props:{modelValue:{type:[String,Number,Object],default:""},id:{type:String,default:null},name:{type:String,default:null},placeholder:{type:String,default:null},required:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:null},loadingIcon:{type:String,default:()=>y.default.loadingIcon},leadingIcon:{type:String,default:null},trailingIcon:{type:String,default:()=>y.default.trailingIcon},trailing:{type:Boolean,default:!1},leading:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padded:{type:Boolean,default:!0},options:{type:Array,default:()=>[]},size:{type:String,default:null,validator(e){return Object.keys(y.size).includes(e)}},color:{type:String,default:()=>y.default.color,validator(e){return[...N.ui.colors,...Object.keys(y.color)].includes(e)}},variant:{type:String,default:()=>y.default.variant,validator(e){return[...Object.keys(y.variant),...Object.values(y.color).flatMap(o=>Object.keys(o))].includes(e)}},optionAttribute:{type:String,default:"label"},valueAttribute:{type:String,default:"value"},selectClass:{type:String,default:null},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:modelValue","change"],setup(e,{emit:o,slots:_}){const{ui:a,attrs:C}=de("select",G(e,"ui"),y,G(e,"class")),{size:s,rounded:I}=ce({ui:a,props:e}),{emitFormChange:n,inputId:b,color:l,size:m,name:A}=_e(e,y),d=c(()=>s.value??m.value),w=t=>{o("update:modelValue",t.target.value)},p=t=>{o("change",t.target.value),n()},i=t=>E(t,e.valueAttribute,""),S=t=>E(t,e.optionAttribute,""),$=t=>["string","number","boolean"].includes(typeof t)?{[e.valueAttribute]:t,[e.optionAttribute]:t}:{...t,[e.valueAttribute]:i(t),[e.optionAttribute]:S(t)},k=c(()=>e.options.map(t=>$(t))),B=c(()=>e.placeholder?[{[e.valueAttribute]:"",[e.optionAttribute]:e.placeholder,disabled:!0},...k.value]:k.value),q=c(()=>{const t=$(e.modelValue),V=B.value.find(D=>D[e.valueAttribute]===t[e.valueAttribute]);return V?V[e.valueAttribute]:""}),R=c(()=>{var V,D;const t=((D=(V=a.value.color)==null?void 0:V[l.value])==null?void 0:D[e.variant])||a.value.variant[e.variant];return me(z(a.value.base,a.value.form,I.value,a.value.size[d.value],e.padded?a.value.padding[d.value]:"p-0",t==null?void 0:t.replaceAll("{color}",l.value),(u.value||_.leading)&&a.value.leading.padding[d.value],(M.value||_.trailing)&&a.value.trailing.padding[d.value]),e.placeholder&&!e.modelValue&&a.value.placeholder,e.selectClass)}),u=c(()=>e.icon&&e.leading||e.icon&&!e.trailing||e.loading&&!e.trailing||e.leadingIcon),M=c(()=>e.icon&&e.trailing||e.loading&&e.trailing||e.trailingIcon),ae=c(()=>e.loading?e.loadingIcon:e.leadingIcon||e.icon),te=c(()=>e.loading&&!u.value?e.loadingIcon:e.trailingIcon||e.icon),le=c(()=>z(a.value.icon.leading.wrapper,a.value.icon.leading.pointer,a.value.icon.leading.padding[d.value])),ne=c(()=>z(a.value.icon.base,l.value&&N.ui.colors.includes(l.value)&&a.value.icon.color.replaceAll("{color}",l.value),a.value.icon.size[d.value],e.loading&&a.value.icon.loading)),ie=c(()=>z(a.value.icon.trailing.wrapper,a.value.icon.trailing.pointer,a.value.icon.trailing.padding[d.value])),oe=c(()=>z(a.value.icon.base,l.value&&N.ui.colors.includes(l.value)&&a.value.icon.color.replaceAll("{color}",l.value),a.value.icon.size[d.value],e.loading&&!u.value&&a.value.icon.loading));return{ui:a,attrs:C,name:A,inputId:b,normalizedOptionsWithPlaceholder:B,normalizedValue:q,isLeading:u,isTrailing:M,selectClass:R,leadingIconName:ae,leadingIconClass:ne,leadingWrapperIconClass:le,trailingIconName:te,trailingIconClass:oe,trailingWrapperIconClass:ie,onInput:w,onChange:p}}}),$e=["id","name","value","required","disabled"],ke=["value","label"],Ve=["value","selected","disabled","textContent"],ze=["value","selected","disabled","textContent"];function Ue(e,o,_,a,C,s){const I=Q;return g(),f("div",{class:U(e.ui.wrapper)},[h("select",ve({id:e.inputId,name:e.name,value:e.modelValue,required:e.required,disabled:e.disabled,class:e.selectClass},e.attrs,{onInput:o[0]||(o[0]=(...n)=>e.onInput&&e.onInput(...n)),onChange:o[1]||(o[1]=(...n)=>e.onChange&&e.onChange(...n))}),[(g(!0),f(O,null,L(e.normalizedOptionsWithPlaceholder,(n,b)=>(g(),f(O,null,[n.children?(g(),f("optgroup",{key:`${n[e.valueAttribute]}-optgroup-${b}`,value:n[e.valueAttribute],label:n[e.optionAttribute]},[(g(!0),f(O,null,L(n.children,(l,m)=>(g(),f("option",{key:`${l[e.valueAttribute]}-${b}-${m}`,value:l[e.valueAttribute],selected:l[e.valueAttribute]===e.normalizedValue,disabled:l.disabled,textContent:j(l[e.optionAttribute])},null,8,Ve))),128))],8,ke)):(g(),f("option",{key:`${n[e.valueAttribute]}-${b}`,value:n[e.valueAttribute],selected:n[e.valueAttribute]===e.normalizedValue,disabled:n.disabled,textContent:j(n[e.optionAttribute])},null,8,ze))],64))),256))],16,$e),e.isLeading&&e.leadingIconName||e.$slots.leading?(g(),f("span",{key:0,class:U(e.leadingWrapperIconClass)},[W(e.$slots,"leading",{disabled:e.disabled,loading:e.loading},()=>[r(I,{name:e.leadingIconName,class:U(e.leadingIconClass)},null,8,["name","class"])],!0)],2)):P("",!0),e.isTrailing&&e.trailingIconName||e.$slots.trailing?(g(),f("span",{key:1,class:U(e.trailingWrapperIconClass)},[W(e.$slots,"trailing",{disabled:e.disabled,loading:e.loading},()=>[r(I,{name:e.trailingIconName,class:U(e.trailingIconClass),"aria-hidden":"true"},null,8,["name","class"])],!0)],2)):P("",!0)],2)}const Ne=ue(Se,[["render",Ue],["__scopeId","data-v-d32e77ab"]]),Be={class:"flex items-center justify-between"},De=T({__name:"CreateSerialBtnComponent",props:{onRefresh:{type:Function}},async setup(e){var w;let o,_;const a=e,C=we({email:Z().email("Invalid email").required("Required"),password:Z().min(8,"Must be at least 8 characters").required("Required")}),s=X({data:{districtId:"",email:void 0,password:void 0,role:"user",notes:""},modal:!1}),I=async()=>{const{execute:p}=await ee.create({role:s.value.data.role,districtId:s.value.data.districtId,notes:"test"});p()};async function n(){await I(),await a.onRefresh(),s.value.modal=!1}const b=H();ge(async()=>{await b.fetchDistricts()});const l=[{label:"DistrictLeader",value:"districtLeader"},{label:"User",value:"user"}],m=H(),{data:A}=([o,_]=Y(()=>be.getAll()),o=await o,_(),o),d=(w=A.value)==null?void 0:w.districts;return Array.isArray(d)&&m.saveIDs(d),(p,i)=>{const S=x,$=Ne,k=Ie,B=Ae,q=Ce,R=he;return g(),f(O,null,[r(S,{onClick:i[0]||(i[0]=u=>s.value.modal=!0)},{default:v(()=>i[6]||(i[6]=[J(" 新增序號 ")])),_:1}),r(R,{modelValue:s.value.modal,"onUpdate:modelValue":i[5]||(i[5]=u=>s.value.modal=u)},{default:v(()=>[r(q,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:v(()=>[h("div",Be,[i[7]||(i[7]=h("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"}," Modal ",-1)),r(S,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:i[1]||(i[1]=u=>s.value.modal=!1)})])]),default:v(()=>[h("div",null,[r(B,{title:"新增序號",schema:F(C),state:s.value.data,class:"space-y-4"},{default:v(()=>[r(k,{label:"角色",name:"role"},{default:v(()=>[r($,{modelValue:s.value.data.role,"onUpdate:modelValue":i[2]||(i[2]=u=>s.value.data.role=u),color:"primary",options:l},null,8,["modelValue"])]),_:1}),r(k,{label:"選擇區ID",name:"districtId"},{default:v(()=>[r($,{modelValue:s.value.data.districtId,"onUpdate:modelValue":i[3]||(i[3]=u=>s.value.data.districtId=u),color:"primary",options:F(b).districts,"value-attribute":"_id","option-attribute":"name",onChange:i[4]||(i[4]=u=>s.value.data.districtId=u)},null,8,["modelValue","options"])]),_:1}),r(S,{type:"submit",onClick:n},{default:v(()=>i[8]||(i[8]=[J(" Submit ")])),_:1})]),_:1},8,["schema","state"])])]),_:1})]),_:1},8,["modelValue"])],64)}}}),Oe={class:"flex justify-end"},je={style:{"white-space":"normal","max-width":"200px"}},He=T({__name:"serial",async setup(e){let o,_;const a=X([]),{data:C,execute:s}=([o,_]=Y(()=>ee.getAll({transform:l=>l.userSerialNumber.map(m=>{var A;return{id:m._id,isUsed:m.isUsed?"已使用":"未使用",districtId:((A=m.districtId)==null?void 0:A.name)||"未指定",role:m.role||"未指定",notes:m.notes||"無備註"}})||[]})),o=await o,_(),o);a.value=C.value;const I=[{key:"id",label:"ID"},{key:"isUsed",label:"狀態"},{key:"districtId",label:"區"},{key:"role",label:"權限"},{key:"notes",label:"備註"},{key:"actions"}],n=l=>[[{label:"Edit",icon:"i-heroicons-pencil-square-20-solid",click:()=>console.log("Edit",l.id)}]],b=async()=>{await fe(),await s(),a.value=C.value};return s(),(l,m)=>{const A=x,d=pe,w=ye;return g(),f("div",null,[h("div",Oe,[r(De,{"on-refresh":b})]),r(w,{rows:F(a),columns:I},{"role-data":v(({row:p})=>[h("span",je,j(p.role),1)]),"isUsed-data":v(({row:p})=>[h("span",null,j(p.isUsed),1)]),"actions-data":v(({row:p})=>[r(d,{items:n(p)},{default:v(()=>[r(A,{color:"gray",variant:"ghost",icon:"i-heroicons-ellipsis-horizontal-20-solid"})]),_:2},1032,["items"])]),_:1},8,["rows"])])}}});export{He as default};
