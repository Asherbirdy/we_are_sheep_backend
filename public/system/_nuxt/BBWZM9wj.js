import{_ as q,a as z}from"./C_eTq8I0.js";import{_ as J,a as K}from"./xO2dniIr.js";import{f as P,r as v,i as V,o as Q,c as R,a as l,b as a,w as r,h as b,d as W,t as X,j as x,v as h,k as Z}from"./B0J0WvHt.js";import{_ as ee}from"./BSdAw5oD.js";import{_ as te}from"./jZC4qxGa.js";import{_ as oe}from"./Dozi95TJ.js";import{u as y}from"./BmPcufqi.js";import{u as le}from"./BscYKFh0.js";import"./toTgdlMQ.js";import"./DYXc8vUg.js";import"./ToWMlutv.js";import"./CRmINWLG.js";import"./DDfxx48F.js";const ne={class:"flex px-3 gap-2 py-3.5 border-b border-gray-200"},ae={class:"flex gap-2 align-end"},se={class:"flex items-center justify-between"},de={class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},re={class:"max-w-lg mx-auto space-y-6 p-8 bg-white rounded-lg shadow-lg"},ie={class:"space-y-4"},ue=["disabled"],Ve=P({__name:"activity",setup(me){const M=le(),m=Array.from({length:51},(o,e)=>({label:`${2024+e}年`,value:`${2024+e}`})),c=Array.from({length:12},(o,e)=>({label:`${e+1}月`,value:`${e+1}`})),g=Array.from({length:31},(o,e)=>({label:`${e+1}日`,value:`${e+1}`})),U=v(),s=V({selectedYear:m[0].value,selectedMonth:c[0].value}),D=v([{key:"date",label:"日期"},{key:"title",label:"標題"},{key:"content",label:"內容"},{key:"createdAt",label:"建立日期"},{key:"actions"}]),C=v([]),f=async o=>{var i;const{data:e}=await y.showActivity({year:o.selectedYear,month:o.selectedMonth});C.value=((i=e.value)==null?void 0:i.data)||[]};f(s);const T=()=>{f(s)},F=o=>{s.selectedMonth=o.value},Y=o=>{s.selectedYear=o.value},u=v(!1),d=v("create"),t=V({id:"",selectedYear:m[0].value,selectedMonth:c[0].value,selectedDay:g[0].value,selectTime:"",FormTitle:"",FormContent:""}),A=o=>{t.selectedYear=o.value},$=o=>{t.selectedMonth=o.value},S=o=>{t.selectedDay=o.value},k=()=>{t.id="",t.selectedYear=m[0].value,t.selectedMonth=c[0].value,t.selectedDay=g[0].value,t.selectTime="",t.FormTitle="",t.FormContent=""};async function N(){let o={activityId:t.id,title:t.FormTitle,content:t.FormContent};d.value==="create"&&(o={...o,year:Number.parseInt(t.selectedYear,10),month:String(Number.parseInt(t.selectedMonth,10)).padStart(2,0),day:String(Number.parseInt(t.selectedDay,10)).padStart(2,0),time:t.selectTime}),await(d.value==="create"?y.addActivity:y.putActivity)(o).then(()=>{u.value=!1,k(),f(s)}).catch(i=>{throw new Error(i)})}const j=o=>{u.value=!0,d.value="edit";const e=M(o.date);t.id=o._id,t.selectedYear=o.year,t.selectedMonth=o.month,t.selectedDay=e.format("DD"),t.selectTime=e.format("HH:mm"),t.FormTitle=o.title,t.FormContent=o.content},I=()=>{k(),u.value=!0,d.value="create"},B=o=>{y.deleteActivity(o).then(()=>{f(s)}).catch(e=>{throw new Error(e)})};return(o,e)=>{const i=q,w=K,p=Z,E=J,O=ee,_=z,H=te,G=oe;return Q(),R("div",null,[l("div",ne,[a(E,{ref_key:"form",ref:U,state:s},{default:r(()=>[l("div",ae,[a(w,{label:"年",name:"selectedYear"},{default:r(()=>[a(i,{modelValue:s.selectedYear,"onUpdate:modelValue":e[0]||(e[0]=n=>s.selectedYear=n),options:b(m),placeholder:"年",class:"w-20",onChange:Y},null,8,["modelValue","options"])]),_:1}),a(w,{label:"月",name:"selectedMonth"},{default:r(()=>[a(i,{modelValue:s.selectedMonth,"onUpdate:modelValue":e[1]||(e[1]=n=>s.selectedMonth=n),options:b(c),placeholder:"月",class:"w-20",onChange:F},null,8,["modelValue","options"])]),_:1}),a(p,{onClick:T},{default:r(()=>e[10]||(e[10]=[W("查詢")])),_:1}),a(p,{label:"新增活動",onClick:I})])]),_:1},8,["state"])]),a(O,{rows:C.value,columns:D.value},{"actions-data":r(({row:n})=>[a(p,{label:"編輯",class:"mr-2",onClick:L=>j(n)},null,8,["onClick"]),a(p,{label:"刪除",onClick:L=>B(n._id)},null,8,["onClick"])]),_:1},8,["rows","columns"]),a(G,{modelValue:u.value,"onUpdate:modelValue":e[9]||(e[9]=n=>u.value=n),"prevent-close":""},{default:r(()=>[a(H,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:r(()=>[l("div",se,[l("h3",de,X(d.value==="create"?"新增活動":"編輯活動"),1),a(p,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:e[2]||(e[2]=n=>u.value=!1)})])]),default:r(()=>[l("div",re,[e[17]||(e[17]=l("div",{class:"text-2xl font-semibold text-gray-800 text-center"},"活動資訊輸入",-1)),l("div",ie,[l("div",null,[e[11]||(e[11]=l("label",{for:"year",class:"block text-sm font-medium text-gray-700"},"年份",-1)),a(_,{modelValue:t.selectedYear,"onUpdate:modelValue":e[3]||(e[3]=n=>t.selectedYear=n),options:b(m),onChange:A,disabled:d.value==="edit"},null,8,["modelValue","options","disabled"])]),l("div",null,[e[12]||(e[12]=l("label",{for:"month",class:"block text-sm font-medium text-gray-700"},"月份",-1)),a(_,{modelValue:t.selectedMonth,"onUpdate:modelValue":e[4]||(e[4]=n=>t.selectedMonth=n),options:b(c),onChange:$,disabled:d.value==="edit"},null,8,["modelValue","options","disabled"])]),l("div",null,[e[13]||(e[13]=l("label",{for:"day",class:"block text-sm font-medium text-gray-700"},"日期",-1)),a(_,{modelValue:t.selectedDay,"onUpdate:modelValue":e[5]||(e[5]=n=>t.selectedDay=n),options:b(g),onChange:S,disabled:d.value==="edit"},null,8,["modelValue","options","disabled"])]),l("div",null,[e[14]||(e[14]=l("label",{for:"time",class:"block text-sm font-medium text-gray-700"},"時間",-1)),x(l("input",{id:"time","onUpdate:modelValue":e[6]||(e[6]=n=>t.selectTime=n),type:"time",class:"mt-1 block w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",disabled:d.value==="edit"},null,8,ue),[[h,t.selectTime]])]),l("div",null,[e[15]||(e[15]=l("label",{for:"title",class:"block text-sm font-medium text-gray-700"},"標題",-1)),x(l("input",{id:"title","onUpdate:modelValue":e[7]||(e[7]=n=>t.FormTitle=n),type:"text",class:"mt-1 block w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",placeholder:"請輸入標題"},null,512),[[h,t.FormTitle]])]),l("div",null,[e[16]||(e[16]=l("label",{for:"content",class:"block text-sm font-medium text-gray-700"},"內容",-1)),x(l("textarea",{id:"content","onUpdate:modelValue":e[8]||(e[8]=n=>t.FormContent=n),rows:"4",class:"mt-1 block w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm",placeholder:"請輸入內容"},null,512),[[h,t.FormContent]])])]),l("div",{class:"flex justify-center"},[l("button",{type:"button",class:"bg-blue-600 text-white px-6 py-2 rounded-lg shadow-md hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:outline-none",onClick:N}," 提交 ")])])]),_:1})]),_:1},8,["modelValue"])])}}});export{Ve as default};
